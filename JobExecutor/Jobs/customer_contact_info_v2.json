{
  "jobName": "CustomerContactInfoV2",
  "firstEffectiveDate": "2024-10-01",
  "modules": [
    {
      "type": "DataSourcing",
      "resultName": "phone_numbers",
      "schema": "datalake",
      "table": "phone_numbers",
      "columns": ["customer_id", "phone_type", "phone_number"]
    },
    {
      "type": "DataSourcing",
      "resultName": "email_addresses",
      "schema": "datalake",
      "table": "email_addresses",
      "columns": ["customer_id", "email_address", "email_type"]
    },
    {
      "type": "Transformation",
      "resultName": "contact_info",
      "sql": "SELECT customer_id, 'Phone' AS contact_type, phone_type AS contact_subtype, phone_number AS contact_value, as_of FROM phone_numbers UNION ALL SELECT customer_id, 'Email' AS contact_type, email_type AS contact_subtype, email_address AS contact_value, as_of FROM email_addresses ORDER BY customer_id, contact_type, contact_subtype"
    },
    {
      "type": "DataFrameWriter",
      "source": "contact_info",
      "targetTable": "customer_contact_info",
      "writeMode": "Append",
      "targetSchema": "double_secret_curated"
    }
  ]
}
