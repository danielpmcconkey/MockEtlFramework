{
  "jobName": "DailyTransactionVolumeV2",
  "firstEffectiveDate": "2024-10-01",
  "modules": [
    {
      "type": "DataSourcing",
      "resultName": "daily_transaction_summary",
      "schema": "curated",
      "table": "daily_transaction_summary",
      "columns": ["transaction_count", "total_amount"]
    },
    {
      "type": "Transformation",
      "resultName": "daily_vol",
      "sql": "SELECT dts.as_of, CAST(SUM(dts.transaction_count) AS INTEGER) AS total_transactions, ROUND(SUM(dts.total_amount), 2) AS total_amount, ROUND(SUM(dts.total_amount) * 1.0 / SUM(dts.transaction_count), 2) AS avg_amount FROM daily_transaction_summary dts GROUP BY dts.as_of ORDER BY dts.as_of"
    },
    {
      "type": "DataFrameWriter",
      "source": "daily_vol",
      "targetTable": "daily_transaction_volume",
      "writeMode": "Append",
      "targetSchema": "double_secret_curated"
    }
  ]
}
