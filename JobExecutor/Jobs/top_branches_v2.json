{
  "jobName": "TopBranchesV2",
  "firstEffectiveDate": "2024-10-01",
  "modules": [
    {
      "type": "DataSourcing",
      "resultName": "branch_summary",
      "schema": "curated",
      "table": "branch_visit_summary",
      "columns": ["branch_id", "branch_name", "visit_count"]
    },
    {
      "type": "Transformation",
      "resultName": "top_branches",
      "sql": "SELECT branch_id, branch_name, visit_count AS total_visits, RANK() OVER (ORDER BY visit_count DESC) AS rank, as_of FROM branch_summary ORDER BY rank, branch_id"
    },
    {
      "type": "DataFrameWriter",
      "source": "top_branches",
      "targetTable": "top_branches",
      "writeMode": "Overwrite",
      "targetSchema": "double_secret_curated"
    }
  ]
}
